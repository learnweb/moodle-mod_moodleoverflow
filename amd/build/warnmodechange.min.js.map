{"version":3,"file":"warnmodechange.min.js","sources":["../src/warnmodechange.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Warns on changing the subscription mode.\n *\n * @module     mod_moodleoverflow/warnmodechange\n * @copyright  2022 Justus Dieckmann WWU\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport {get_string as getString} from 'core/str';\nimport Notification from 'core/notification';\nimport Prefetch from 'core/prefetch';\n\n/**\n * Init function.\n * @param {string} previousSetting\n */\nexport function init(previousSetting) {\n    Prefetch.prefetchStrings('mod_moodleoverflow', ['switchtooptional', 'switchtoauto']);\n    Prefetch.prefetchStrings('moodle', ['confirm', 'cancel']);\n    const form = document.querySelector('form.mform');\n    const select = document.getElementById('id_forcesubscribe');\n    form.onsubmit = async(e) => {\n        const value = select.selectedOptions[0].value;\n        if (value == previousSetting || value == 1 || value == 3) {\n            return;\n        }\n        e.preventDefault();\n        await Notification.confirm(\n            await getString('confirm'),\n            await getString(value == 0 ? 'switchtooptional' : 'switchtoauto', 'mod_moodleoverflow'),\n            await getString('confirm'),\n            await getString('cancel'),\n            () => {\n                // Prevent this listener from preventing the event again.\n                form.onsubmit = undefined;\n                form.requestSubmit(e.submitter);\n            }, undefined);\n    };\n}"],"names":["_interopRequireDefault","e","__esModule","default","previousSetting","Prefetch","prefetchStrings","form","document","querySelector","select","getElementById","onsubmit","async","value","selectedOptions","preventDefault","Notification","confirm","getString","undefined","requestSubmit","submitter","_notification","_prefetch"],"mappings":"sJAwBqC,SAAAA,uBAAAC,GAAAA,OAAAA,GAAAA,EAAAC,WAAAD,EAAAE,CAAAA,QAAAF,EAAA;;;;;;;2EAM9B,SAAcG,iBACjBC,UAAQF,QAACG,gBAAgB,qBAAsB,CAAC,mBAAoB,iBACpED,UAAQF,QAACG,gBAAgB,SAAU,CAAC,UAAW,WAC/C,MAAMC,KAAOC,SAASC,cAAc,cAC9BC,OAASF,SAASG,eAAe,qBACvCJ,KAAKK,SAAWC,UACZ,MAAMC,MAAQJ,OAAOK,gBAAgB,GAAGD,MACpCA,OAASV,iBAA4B,GAATU,OAAuB,GAATA,QAG9Cb,EAAEe,uBACIC,sBAAaC,cACT,EAAAC,iBAAU,iBACV,EAAAA,KAAAA,YAAmB,GAATL,MAAa,mBAAqB,eAAgB,4BAC5D,EAAAK,iBAAU,iBACV,EAAAA,KAAAA,YAAU,UAChB,KAEIZ,KAAKK,cAAWQ,EAChBb,KAAKc,cAAcpB,EAAEqB,iBACtBF,IAEf,EA7BAG,cAAAvB,uBAAAuB,eACAC,UAAAxB,uBAAAwB,UA4BC"}