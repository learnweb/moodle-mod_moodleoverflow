{"version":3,"file":"warnmodechange.min.js","sources":["../src/warnmodechange.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Warns on changing the subscription mode.\n *\n * @module     mod_moodleoverflow/warnmodechange\n * @copyright  2022 Justus Dieckmann WWU\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport {get_string as getString} from 'core/str';\nimport Notification from 'core/notification';\nimport Prefetch from 'core/prefetch';\n\n/**\n * Init function.\n * @param {string} previousSetting\n */\nexport function init(previousSetting) {\n    Prefetch.prefetchStrings('mod_moodleoverflow', ['switchtooptional', 'switchtoauto']);\n    Prefetch.prefetchStrings('moodle', ['confirm', 'cancel']);\n    const form = document.querySelector('form.mform');\n    const select = document.getElementById('id_forcesubscribe');\n    form.onsubmit = async(e) => {\n        const value = select.selectedOptions[0].value;\n        if (value == previousSetting || value == 1 || value == 3) {\n            return;\n        }\n        e.preventDefault();\n        await Notification.confirm(\n            await getString('confirm'),\n            await getString(value == 0 ? 'switchtooptional' : 'switchtoauto', 'mod_moodleoverflow'),\n            await getString('confirm'),\n            await getString('cancel'),\n            () => {\n                // Prevent this listener from preventing the event again.\n                form.onsubmit = undefined;\n                form.requestSubmit(e.submitter);\n            }, undefined);\n    };\n}"],"names":["previousSetting","prefetchStrings","form","document","querySelector","select","getElementById","onsubmit","e","value","selectedOptions","preventDefault","Notification","undefined","requestSubmit","submitter","confirm"],"mappings":"mhBA8BqBA,mCACRC,gBAAgB,qBAAsB,CAAC,mBAAoB,mCAC3DA,gBAAgB,SAAU,CAAC,UAAW,eACzCC,KAAOC,SAASC,cAAc,cAC9BC,OAASF,SAASG,eAAe,qBACvCJ,KAAKK,sCAAW,iBAAMC,sHACZC,MAAQJ,OAAOK,gBAAgB,GAAGD,QAC3BT,iBAA4B,GAATS,OAAuB,GAATA,4EAG9CD,EAAEG,6BACIC,uCACI,mBAAU,qEACV,mBAAmB,GAATH,MAAa,mBAAqB,eAAgB,iFAC5D,mBAAU,sEACV,mBAAU,+DAChB,WAEIP,KAAKK,cAAWM,EAChBX,KAAKY,cAAcN,EAAEO,6BACtBF,+BATYG"}