define("mod_moodleoverflow/reviewing",["exports","core/ajax","core/prefetch","core/templates","core/str"],(function(_exports,_ajax,_prefetch,_templates,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=function(){_prefetch.default.prefetchTemplates(["mod_moodleoverflow/reject_post_form","mod_moodleoverflow/review_buttons"]),_prefetch.default.prefetchStrings("mod_moodleoverflow",["post_was_approved","jump_to_next_post_needing_review","there_are_no_posts_needing_review","post_was_rejected"]),document.getElementById("moodleoverflow-posts").onclick=(fn=regeneratorRuntime.mark((function _callee(e){var action,post,reviewRow,postID,nextPostURL,message,rejectMessage,args,_nextPostURL,_message;return regeneratorRuntime.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(action=e.target.getAttribute("data-moodleoverflow-action")){_context.next=3;break}return _context.abrupt("return");case 3:if(post=e.target.closest("*[data-moodleoverflow-postid]"),reviewRow=e.target.closest(".reviewrow"),postID=post.getAttribute("data-moodleoverflow-postid"),"approve"!==action){_context.next=33;break}return reviewRow.innerHTML=".",_context.next=10,_ajax.default.call([{methodname:"mod_moodleoverflow_review_approve_post",args:{postid:postID}}])[0];case 10:return nextPostURL=_context.sent,_context.next=13,(0,_str.get_string)("post_was_approved","mod_moodleoverflow");case 13:if(_context.t0=_context.sent,message=_context.t0+" ",!nextPostURL){_context.next=25;break}return _context.t1=message,_context.t2='<a href="'.concat(nextPostURL,'">'),_context.next=20,(0,_str.get_string)("jump_to_next_post_needing_review","mod_moodleoverflow");case 20:_context.t3=_context.sent,_context.t4=_context.t2+_context.t3,message=_context.t1+=_context.t4+"</a>",_context.next=29;break;case 25:return _context.t5=message,_context.next=28,(0,_str.get_string)("there_are_no_posts_needing_review","mod_moodleoverflow");case 28:message=_context.t5+=_context.sent;case 29:reviewRow.innerHTML=message,post.classList.remove("pendingreview"),_context.next=73;break;case 33:if("reject"!==action){_context.next=40;break}return reviewRow.innerHTML=".",_context.next=37,_templates.default.render("mod_moodleoverflow/reject_post_form",{});case 37:reviewRow.innerHTML=_context.sent,_context.next=73;break;case 40:if("reject-submit"!==action){_context.next=68;break}return rejectMessage=post.querySelector("textarea.reject-reason").value.toString().trim(),reviewRow.innerHTML=".",args={postid:postID,reason:rejectMessage||null},_context.next=46,_ajax.default.call([{methodname:"mod_moodleoverflow_review_reject_post",args:args}])[0];case 46:return _nextPostURL=_context.sent,_context.next=49,(0,_str.get_string)("post_was_rejected","mod_moodleoverflow");case 49:if(_context.t6=_context.sent,_message=_context.t6+" ",!_nextPostURL){_context.next=61;break}return _context.t7=_message,_context.t8='<a href="'.concat(_nextPostURL,'">'),_context.next=56,(0,_str.get_string)("jump_to_next_post_needing_review","mod_moodleoverflow");case 56:_context.t9=_context.sent,_context.t10=_context.t8+_context.t9,_message=_context.t7+=_context.t10+"</a>",_context.next=65;break;case 61:return _context.t11=_message,_context.next=64,(0,_str.get_string)("there_are_no_posts_needing_review","mod_moodleoverflow");case 64:_message=_context.t11+=_context.sent;case 65:reviewRow.innerHTML=_message,_context.next=73;break;case 68:if("reject-cancel"!==action){_context.next=73;break}return reviewRow.innerHTML=".",_context.next=72,_templates.default.render("mod_moodleoverflow/review_buttons",{});case 72:reviewRow.innerHTML=_context.sent;case 73:case"end":return _context.stop()}}),_callee)})),_ref=function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))},function(_x){return _ref.apply(this,arguments)});var fn,_ref},_ajax=_interopRequireDefault(_ajax),_prefetch=_interopRequireDefault(_prefetch),_templates=_interopRequireDefault(_templates)}));

//# sourceMappingURL=reviewing.min.js.map